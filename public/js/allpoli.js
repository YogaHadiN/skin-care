function afiCount(){$(".afi_count").each(function(a,t){var e=$(this).val();e=e.replace(",","."),e=e.replace(" ",""),""==e&&(e=0),total_afi_count+=parseFloat(e)}),$("#total_afi").val(total_afi_count+" cm"),hasil(),total_afi_count=0}function getDiagnosaByICD(a){$.ajax({url:base+"/poli/ajax/diag",type:"GET",data:{icd10:a}}).done(function(a){a=JSON.parse(a);for(var t="",e=0;e<a.length;e++)t+='<tr class="anchor2">',t+="<td>"+a[e].id+"</td>",t+="<td>"+a[e].diagnosa+"</td>",t+="</tr>";$("#ajax4").html(t),$("#tambahDiagnosa").val("").focus()}).fail(function(){alert("Error!")})}function insertDiagnosa(){var a=$("#lblICD").html(),t=$("#tambahDiagnosa").val();$.ajax({url:base+"/poli/ajax/indiag",type:"POST",data:{icd10:a,diagnosa:t,_token:$("#token").val()}}).done(function(e){if(e=$.trim(e),"0"==e)alert(t+" GAGAL diinput");else if("01"==e)validasi("#tambahDiagnosa","Sudah ada!!");else{e=JSON.parse(e),alert(t+" berhasil diinput"),getDiagnosaByICD(a);var i='<option value="'+e.id+'">'+e.diagnosa+" - "+e.diagnosaICD+"</option>";$("#ddlDiagnosa").append(i).selectpicker("refresh")}}).fail(function(){alert("Error!")})}function confirmICD(){var a=$("table#GridView4 tbody tr").filter(function(){var a="rgb(51, 122, 183)";return $(this).css("background-color")==a}).find("td:first-child").html(),t=$("table#GridView4 tbody tr").filter(function(){var a="rgb(51, 122, 183)";return $(this).css("background-color")==a}).find("td:nth-child(2)").html();$("#lblICD").html(a),$("#lblDiagnosaICD").html(t),getDiagnosaByICD(a),$("#showModal2").click(),$("#hideModal1").click()}function confirmDiagnosa(){var a=$("table#GridView2 tbody tr").filter(function(){var a="rgb(51, 122, 183)";return $(this).css("background-color")==a}).find("td:first-child").html();$("#ddlDiagnosa").val(a).selectpicker("refresh"),$("#diagnosa").val(a),$("#hideModal2").click(),$("#keterangan_diagnosa").focus()}function table_ICD(){$.post(base+"/poli/ajax/pilih",{byICD:$("#byICD").val(),byDiagnosa:$("#byDiagnosa").val(),_token:$("#token").val()},function(a){for(var t="",e=0;e<a.length;e++)t+='<tr class="anchor2">',t+="<td>"+a[e].id+"</td>",t+="<td>"+a[e].diagnosaICD+"</td>",t+="</tr>";$("#temp").html(t)})}function insertTerapi(){var a=$("#ddlNamaObat option:selected").text(),t=$("#txtjumlah").val(),e=$("#ddlsigna").val(),i=$("#ddlAturanMinum").val(),n=/syrup/,r=n.test(a),d=$("#ddlNamaObat").attr("disabled");"undefined"!=typeof d&&d!==!1&&$("#ddlNamaObat").removeAttr("disabled").selectpicker("refresh");var d=$("#tipeResep").attr("disabled");if("undefined"!=typeof d&&d!==!1&&$("#tipeResep").removeAttr("disabled").selectpicker("refresh"),""==$("#ddlNamaObat").val()||""==t||""==e||""==i)""==$("#ddlNamaObat").val()&&validasi("#ddlNamaObat","Harus Diisi!"),""==$("#txtjumlah").val()&&validasi("#txtjumlah","Harus Diisi!"),""==$("#ddlsigna").val()&&validasi2("#ddlsigna","Harus Diisi!"),""==$("#ddlAturanMinum").val()&&validasi2("#ddlAturanMinum","Harus Diisi!");else if(r&&t>1){var l=confirm("Anda akan menginput SIRUP DALAM JUMLAH BANYAK, hal ini tidak lazim dan bisa merupakan suatu kesalahan. Lanjutkan?");l&&insert()}else if(t>20){var l=confirm("Jumlah nya bisa jadi terlalu banyak. Lanjutkan?");l&&insert()}else{var s=getIdFormula(),o="",u=!1;if(data.length>0)for(var p=0;p<data.length;p++)if(data[p].formula_id==s){u=!0,o=data[p].merek;break}if(u){var l=confirm("Formula yang sama sudah dimasukkan dengan Nama = "+o+", Lanjutkan?");l&&insert()}else insert()}}function formSigna(){return $.ajax({url:"ajaxSigna.php",type:"POST",data:{_token:$("#token").val()}}).done(function(a){a=$.trim(a),$("#ajax6").html(a)}).fail(function(){}).complete(function(){$("#GridView4").dataTable({responsive:!0}),$("#inputSigna").val(""),$("#modalSigna input.input-sm").keypress(function(a){var t=a.keyCode||a.which;13==t&&insertSigna()})}),!1}function insertSigna(){var a=$("#inputSigna").val();return""!=a?($.ajax({url:base+"/poli/ajax/insigna",type:"POST",data:{signa:a,_token:$("#token").val()}}).done(function(t){if(t=JSON.parse(t),""!=t.warning)validasi("#inputSigna",t.warning);else{var e='<option value="'+t.id+'">'+a+"</option>",i=t.temp;$("#ddlsigna").append(e).val(i.id).selectpicker("refresh");var n="";n+="<tr>",n+="<td>"+i.id+"</td>",n+="<td>"+i.signa+"</td>",n+='<td><button class="btn btn-success btn-xs" value="'+i.id+'" onclick="pilihSigna(this)">Pilih</button></td>',n+="</tr>",$("#tblSigna tbody").html(n).hide().fadeIn(300,function(){$("#modalSigna").modal("hide")})}}).fail(function(){}),!1):(validasi("#inputSigna","Input Tidak Boleh Kosong"),void $("#inputSigna").focus())}function insertAturanMinum(){var a=$("#inputAturanMinum").val();return""!=a?($.ajax({url:base+"/poli/ajax/inatur",type:"POST",data:{aturan:$("#inputAturanMinum").val(),_token:$("#token").val()}}).done(function(t){if(t=JSON.parse(t),""!=t.warning)validasi("#inputAturanMinum",t.warning);else{var e='<option value="'+t.id+'">'+a+"</option>",i=t.temp;$("#ddlAturanMinum").append(e).val(i.id).selectpicker("refresh");var n="";n+="<tr>",n+="<td>"+i.id+"</td>",n+="<td>"+i.aturan_minum+"</td>",n+='<td><button class="btn btn-success btn-xs" value="'+i.id+'" onclick="pilihAturanMinum(this)">Pilih</button></td>',n+="</tr>",$("#tblAturanMinum tbody").html(n).hide().fadeIn(300,function(){$("#modalAturanMinum").modal("hide")})}}).fail(function(){}),!1):(alert("input tidak boleh kosong"),!1)}function ddlSigna(a){return $.ajax({url:"ddlSignaRuangPeriksa.php",type:"POST",data:{ID_SIGNA:a,_token:$("#token").val()}}).done(function(a){a=$.trim(a),$("#ddlsigna").html(a).selectpicker("refresh")}).fail(function(){}),!1}function selesaiPuyer(a){var t=$("#asuransi_id").val();return $("#tipeResep").val("0").selectpicker("refresh"),$(a).fadeOut("400",function(){$("#tipeResep").closest("div").find(".btn-white").closest("div").fadeIn("400")}),"32"==t||"15"==t||"3"==t?$("#ddlNamaObat").val("-1").selectpicker("refresh").closest("div").fadeIn(400):$("#ddlNamaObat").val("-3").selectpicker("refresh").closest("div").fadeIn(400),$("#ddlNamaObat, #tipeResep").prop("disabled",!0).selectpicker("refresh"),$("#ddlsigna, #ddlAturanMinum").val("0").selectpicker("refresh"),$("#ddlsigna, #ddlAturanMinum").closest("div").fadeIn(400),$("#txtjumlah").focus(),!1}function selesaiAdd(a){$("#asuransi_id").val();return $("#tipeResep").val("0").selectpicker("refresh"),$(a).fadeOut("400",function(){$("#tipeResep").closest("div").find(".btn-white").closest("div").fadeIn("400")}),$("#ddlNamaObat").val("-2").selectpicker("refresh").closest("div").fadeIn(400),$("#ddlNamaObat, #tipeResep").prop("disabled",!0).selectpicker("refresh"),$("#ddlsigna, #ddlAturanMinum").val("0").selectpicker("refresh"),$("#ddlsigna, #ddlAturanMinum").closest("div").fadeIn(400),addSatu?$("#txtjumlah").val("1").hide():$("#txtjumlah").val("0").hide(),$("#ddlsigna").closest("div").find(".btn-white").focus(),!1}function optionSyrup(a){$.ajax({url:base+"/DdlMerek/optionsyrup",type:"GET",data:{ID_MEREK:a,asuransi_id:$("#asuransi_id").val()}}).done(function(a){customOption(a)}).fail(function(){}).complete(function(){$("#ddlNamaObat").selectpicker("refresh")})}function optionPuyer(a){$.ajax({url:base+"/DdlMerek/optionpuyer",type:"GET",data:{ID_MEREK:a,asuransi_id:$("#asuransi_id").val()}}).done(function(a){customOption(a)}).fail(function(){}).complete(function(){$("#ddlNamaObat").selectpicker("refresh")})}function optionSemua(a){$.ajax({url:base+"/DdlMerek/alloption",type:"GET",data:{asuransi_id:$("#asuransi_id").val()}}).done(function(a){customOption(a)}).fail(function(){})}function resetSignaAturanMinum(){$("#ddlsigna").val("").selectpicker("refresh"),$("#ddlAturanMinum").val("").selectpicker("refresh"),$("#txtjumlah").val("")}function resetAll(){resetSignaAturanMinum(),$("select.kosong").val("").selectpicker("refresh"),namaObatFocus(),alert("reset all")}function pilihSigna(a){var t=$(a).val();$("#ddlsigna").val(t).selectpicker("refresh"),$("#hideModalSigna").click()}function pilihAturanMinum(a){var t=$(a).val();$("#ddlAturanMinum").val(t).selectpicker("refresh"),$("#hideModalAturanMinum").click()}function insert(){var a=getIdMerek(),t=getIdFormula(),e=getIdRak(),i=getFornas(),n=getHargaJual(),r=$("#tipeResep").val();"D7"==e&&"1"==r&&(i="1");var d=$("#ddlNamaObat option:selected").text(),l=$("#txtjumlah").val();$("#ddlsigna").val(),$("#ddlAturanMinum").val();$("#legendpop").popover("hide"),data[data.length]={jumlah:l,merek_id:a,rak_id:e,harga_jual_ini:n,formula_id:t,merek_obat:d,fornas:i,signa:$("#ddlsigna option:selected").text(),aturan_minum:$("#ddlAturanMinum option:selected").text()};var s=JSON.stringify(data);$("#terapi").val(s),sesuaikanInputResep(a);var o=resepJson(s);viewResep(o[1]),namaObatFocus(),$(".kosong").val(""),$("select.kosong").selectpicker("refresh"),$("#ddlsigna").val()>0&&(resetSignaAturanMinum(),alert("kosongkan"))}function customOption(a){var t=getIdMerek();a=JSON.parse(a);for(var e="",i=0;i<a.length;i++)e+=a[i].merek_id==t?'<option data-custom-value=\'{ "formula_id" : "'+a[i].formula_id+'", "rak_id" : "'+a[i].rak_id+'", "merek_id" : "'+a[i].merek_id+'", "harga_beli" : "'+a[i].harga_beli+'" , "aturan_minum_id" : "'+a[i].aturan_minum_id+'" , "harga_jual" : "'+a[i].harga_jual+'" , "sediaan" : "'+a[i].sediaan+'" , "tidak_dipuyer" : "'+a[i].tidak_dipuyer+'" }\' selected="selected" data-subtext=\''+a[i].komposisi+"' value='"+a[i].merek_id+"' data-peringatan='"+a[i].peringatan+"' data-fornas='"+a[i].fornas+"' data-alternatif='"+a[i].alternatif+"'>"+a[i].merek+"</option>":'<option data-custom-value=\'{ "formula_id" : "'+a[i].formula_id+'", "rak_id" : "'+a[i].rak_id+'", "merek_id" : "'+a[i].merek_id+'", "harga_beli" : "'+a[i].harga_beli+'" , "aturan_minum_id" : "'+a[i].aturan_minum_id+'" , "harga_jual" : "'+a[i].harga_jual+'" , "sediaan" : "'+a[i].sediaan+'" , "tidak_dipuyer" : "'+a[i].tidak_dipuyer+"\" }' data-subtext='"+a[i].komposisi+"' value='"+a[i].merek_id+"' data-peringatan='"+a[i].peringatan+"'  data-fornas='"+a[i].fornas+"' data-alternatif='"+a[i].alternatif+"'>"+a[i].merek+"</option>";$("#ddlNamaObat").html(e).selectpicker("refresh"),$("#bb_aktif").val(""),$("#keterangan_auto_keterangan").hide(),$(".auto").show(500),$("#btn_auto_off").hide(500),namaObatFocus()}function customOption2(a,t){var e=getIdMerek();a=JSON.parse(a);for(var i="",n=0;n<a.length;n++){var r=JSON.stringify(a[n].doses);i+=a[n].merek_id==e?"<option data-dose='"+r+'\' data-custom-value=\'{ "formula_id" : "'+a[n].formula_id+'", "rak_id" : "'+a[n].rak_id+'", "merek_id" : "'+a[n].merek_id+'", "harga_beli" : "'+a[n].harga_beli+'" , "aturan_minum_id" : "'+a[n].aturan_minum_id+'" , "harga_jual" : "'+a[n].harga_jual+'" , "sediaan" : "'+a[n].sediaan+'" , "tidak_dipuyer" : "'+a[n].tidak_dipuyer+'" }\' selected="selected" data-subtext=\''+a[n].komposisi+"' value='"+a[n].merek_id+"' data-peringatan='"+a[n].peringatan+"' data-fornas='"+a[n].fornas+"' data-alternatif='"+a[n].alternatif+"'>"+a[n].merek+"</option>":"<option data-dose='"+r+'\' data-custom-value=\'{ "formula_id" : "'+a[n].formula_id+'", "rak_id" : "'+a[n].rak_id+'", "merek_id" : "'+a[n].merek_id+'", "harga_beli" : "'+a[n].harga_beli+'" , "aturan_minum_id" : "'+a[n].aturan_minum_id+'" , "harga_jual" : "'+a[n].harga_jual+'" , "sediaan" : "'+a[n].sediaan+'" , "tidak_dipuyer" : "'+a[n].tidak_dipuyer+"\" }' data-subtext='"+a[n].komposisi+"' value='"+a[n].merek_id+"' data-peringatan='"+a[n].peringatan+"' data-fornas='"+a[n].fornas+"' data-alternatif='"+a[n].alternatif+"'>"+a[n].merek+"</option>"}$("#ddlNamaObat").html(i).selectpicker("refresh"),$("#keterangan_auto").html(t),$("#keterangan_auto_keterangan").removeClass("hide").hide().slideDown(500),$("#ddlNamaObat").val("").selectpicker("refresh"),$("#ddlAturanMinum").val("").selectpicker("refresh"),$("#ddlsigna").val("").selectpicker("refresh"),$("#txtjumlah").val(""),$(".auto").hide(500),$("#btn_auto_off").show(500),namaObatFocus()}function customOption2a(a,t){var e=getIdMerek();a=JSON.parse(a);for(var i="",n=0;n<a.length;n++){var r=JSON.stringify(a[n].doses);i+=a[n].merek_id==e?"<option data-dose='"+r+'\' data-custom-value=\'{ "formula_id" : "'+a[n].formula_id+'", "rak_id" : "'+a[n].rak_id+'", "merek_id" : "'+a[n].merek_id+'", "harga_beli" : "'+a[n].harga_beli+'" , "aturan_minum_id" : "'+a[n].aturan_minum_id+'" , "harga_jual" : "'+a[n].harga_jual+'" , "sediaan" : "'+a[n].sediaan+'" , "tidak_dipuyer" : "'+a[n].tidak_dipuyer+'" }\' selected="selected" data-subtext=\''+a[n].komposisi+"' value='"+a[n].merek_id+"' data-peringatan='"+a[n].peringatan+"' data-fornas='"+a[n].fornas+"' data-alternatif='"+a[n].alternatif+"'>"+a[n].merek+"</option>":"<option data-dose='"+r+'\' data-custom-value=\'{ "formula_id" : "'+a[n].formula_id+'", "rak_id" : "'+a[n].rak_id+'", "merek_id" : "'+a[n].merek_id+'", "harga_beli" : "'+a[n].harga_beli+'" , "aturan_minum_id" : "'+a[n].aturan_minum_id+'" , "harga_jual" : "'+a[n].harga_jual+'" , "sediaan" : "'+a[n].sediaan+'" , "tidak_dipuyer" : "'+a[n].tidak_dipuyer+"\" }' data-subtext='"+a[n].komposisi+"' value='"+a[n].merek_id+"' data-peringatan='"+a[n].peringatan+"' data-fornas='"+a[n].fornas+"' data-alternatif='"+a[n].alternatif+"'>"+a[n].merek+"</option>"}$("#ddlNamaObat").html(i).selectpicker("refresh"),$("#keterangan_auto").html(t),$("#keterangan_auto_keterangan").removeClass("hide").hide().slideDown(500),$("#ddlNamaObat").val("").selectpicker("refresh"),$("#ddlAturanMinum").val("").selectpicker("refresh"),$("#ddlsigna").val("").selectpicker("refresh"),$("#txtjumlah").val(""),$(".auto").hide(500),$("#btn_auto_off").show(500)}function getIdMerek(){var a=$("#ddlNamaObat").val();if(""!=a){var t=$("#ddlNamaObat option:selected").attr("data-custom-value");a=JSON.parse(t);var e=a.merek_id}else var e="";return e}function getIdFormula(){var a=$("#ddlNamaObat").val();if(""!=a){var t=$("#ddlNamaObat option:selected").attr("data-custom-value");a=JSON.parse(t);var e=a.formula_id}else var e="";return e}function getIdRak(){var a=$("#ddlNamaObat").val();if(""!=a){var t=$("#ddlNamaObat option:selected").attr("data-custom-value");a=JSON.parse(t);var e=a.rak_id}else var e="";return e}function getFornas(){var a=$("#ddlNamaObat").val();if(""!=a)var t=$("#ddlNamaObat option:selected").attr("data-fornas");else var t="";return t}function getHargaJual(){var a=$("#ddlNamaObat").val();if(""!=a){var t=$("#ddlNamaObat option:selected").attr("data-custom-value");a=JSON.parse(t);var e=$("#kali_obat").val(),i=a.harga_jual*parseInt(e)}else var i="";return i}function getAturanMinumId(){var a=$("#ddlNamaObat").val();if(""!=a){var t=$("#ddlNamaObat option:selected").attr("data-custom-value");a=JSON.parse(t);var e=a.aturan_minum_id}else var e="";return e}function getMerek(){var a=$("#ddlNamaObat").val();if(""!=a)var t=$("#ddlNamaObat option:selected").text();else var t="";return t}function getSediaan(){var a=$("#ddlNamaObat").val();if(""!=a){var t=$("#ddlNamaObat option:selected").attr("data-custom-value");a=JSON.parse(t);var e=a.sediaan}else var e="";return e}function getTidakDipuyer(){var a=$("#ddlNamaObat").val();if(""!=a){var t=$("#ddlNamaObat option:selected").attr("data-custom-value");a=JSON.parse(t);var e=a.tidak_dipuyer}else var e="";return e}function panggil(a){alert("panggil")}function rowdel(a){var t=JSON.parse($(a).val());$("#legendpop").popover("hide"),data.splice(t[0].id,t.length);var e=JSON.stringify(data);$("#terapi").val(e);var i=resepJson(e);viewResep(i[1]),"0"==$("#puyer").val()&&"0"==$("#boolAdd").val()&&$("#boolSirupPuyer").val("0");var n="";data.length>0&&(n=data[data.length-1].signa),"Puyer"==n&&"0"==$("#boolSirupPuyer").val()?($("#tipeResep").val("1"),hideTipeResepPuyer(null),tipePuyer()):"Add"==n&&"0"==$("#boolSirupPuyer").val()?($("#tipeResep").val("2"),hideTipeResepSirup2(null),tipeSirup()):"0"==$("#boolSirupPuyer").val()&&($("#tipeResep").closest("div").find(".btn-info").fadeOut("500",function(){$(this).remove()}),$("#tipeResep").closest("div").find(".btn-primary").fadeOut("500",function(){$(this).remove()}),$("#ddlsigna").val("").selectpicker("refresh").closest(".input-group").fadeIn(500),$("#tipeResep").val("0").selectpicker("refresh").closest("div").find(".btn-white").closest("div").fadeIn(500),$("#ddlAturanMinum").val("").selectpicker("refresh").closest(".input-group").fadeIn(500),$("#txtjumlah").val("").selectpicker("refresh").fadeIn(500),optionSemua(null),$("#boolSirupPuyer").val("0"))}function sesuaikanInputResep(a){"0"==$("#tipeResep").val()&&"Add Sirup"==$("#ddlNamaObat option:selected").text()&&($("#txtjumlah").val("").fadeIn(500),optionSemua(a)),"1"==$("#tipeResep").val()&&"0"==$("#boolSirupPuyer").val()?tipePuyer():"2"==$("#tipeResep").val()&&"0"==$("#boolSirupPuyer").val()?tipeSirup():"0"==$("#tipeResep").val()&&"1"==$("#boolSirupPuyer").val()?($("#boolSirupPuyer").val("0"),resetSignaAturanMinum(),optionSemua(a)):"0"!=$("#tipeResep").val()&&""!=$("#tipeResep").val()||resetSignaAturanMinum()}function sesuaikanResep(){"1"==$("#boolAdd").val()?($("#tipeResep").closest("div").find(".btn-white").closest("div").fadeOut("400",function(){var a='<button class="btn btn-primary btn-block" onclick="selesaiAdd(this);return false;" id="selesaikanAdd">Selesaikan Sirup</button>';$("#tipeResep").closest("div").prepend(a).hide().fadeIn(400)}),$("#ddlsigna").val("-2").selectpicker("refresh").closest(".input-group").fadeOut(500),$("#ddlAturanMinum").val("1").selectpicker("refresh").closest(".input-group").fadeOut(500),optionPuyer(null),$("#txtjumlah").val("").selectpicker("refresh").fadeIn(500),namaObatFocus()):"1"==$("#puyer").val()?($("#tipeResep").closest("div").find(".btn-white").closest("div").fadeOut("400",function(){var a='<button class="btn btn-info btn-block" onclick="selesaiPuyer(this);return false;" id="selesaikanPuyer">Selesaikan Puyer</button>';$("#tipeResep").closest("div").prepend(a).hide().fadeIn(400)}),$("#ddlsigna").val("-1").selectpicker("refresh").closest(".input-group").fadeOut(500),$("#ddlAturanMinum").val("1").selectpicker("refresh").closest(".input-group").fadeOut(500),$("#txtjumlah").val("").selectpicker("refresh").fadeIn(500),optionPuyer(null),namaObatFocus()):($("#tipeResep").closest("div").find(".btn-info").fadeOut("500",function(){$(this).remove()}),$("#tipeResep").closest("div").find(".btn-primary").fadeOut("500",function(){$(this).remove()}),$("#ddlsigna").val("").selectpicker("refresh").closest(".input-group").fadeIn(500),$("#tipeResep").val("0").selectpicker("refresh").closest("div").find(".btn-white").closest("div").fadeIn(500),$("#ddlAturanMinum").val("").selectpicker("refresh").closest(".input-group").fadeIn(500),$("#txtjumlah").val("").selectpicker("refresh").fadeIn(500),optionSemua(null),$("#boolSirupPuyer").val("0"))}function tipePuyer(){$("#boolSirupPuyer").val("1"),$("#puyer").val("1"),$("#tipeResep").closest("div").find(".btn-white").closest("div").fadeOut("400",function(){var a='<button class="btn btn-info btn-block" onclick="selesaiPuyer(this);return false;" id="selesaikanPuyer">Selesaikan Puyer</button>';$("#tipeResep").closest("div").prepend(a).hide().fadeIn(400)})}function tipeSirup(){$("#boolSirupPuyer").val("1"),$("#tipeResep").closest("div").find(".btn-white").closest("div").fadeOut("400",function(){var a='<button class="btn btn-primary btn-block" onclick="selesaiAdd(this);return false;" id="selesaikanAdd">Selesaikan Sirup</button>';$("#tipeResep").closest("div").prepend(a).hide().fadeIn(400)}),optionPuyer(null),$("#txtjumlah").val("").selectpicker("refresh").fadeIn(500)}function hideTipeResepPuyer(a){$("#ddlsigna").val("-1").selectpicker("refresh").closest(".input-group").fadeOut(500),$("#ddlAturanMinum").val("1").selectpicker("refresh").closest(".input-group").fadeOut(500),optionPuyer(a)}function hideTipeResepSirup(a){$("#ddlsigna").val("-2").selectpicker("refresh").closest(".input-group").fadeOut(500),$("#txtjumlah").val("1").selectpicker("refresh").fadeOut(500),$("#ddlAturanMinum").val("1").selectpicker("refresh").closest(".input-group").fadeOut(500),optionSyrup(a)}function hideTipeResepSirup2(a){$("#ddlsigna").val("-2").selectpicker("refresh").closest(".input-group").fadeOut(500),$("#txtjumlah").val("1").selectpicker("refresh").fadeOut(500),$("#ddlAturanMinum").val("1").selectpicker("refresh").closest(".input-group").fadeOut(500),optionPuyer(a)}function submitTindakan(){var a=$("#selectTindakan").val();valJson=$.parseJSON(a);var t=valJson.biaya,e=valJson.jenis_tarif_id,i=$("#selectTindakan option:selected").text(),n=$("#keteranganTindakan").val();if(""!=a){dataTindakan[dataTindakan.length]={jenis_tarif_id:e,jenis_tarif:i,biaya:t,keterangan_tindakan:n};var r=JSON.stringify(dataTindakan);$("#tindakan").val(r),viewTindakan(dataTindakan),resetInputTIndakan()}else validasi("#selectTindakan","Harus Diisi!"),resetInputTIndakan();optionBilaNebuBpjs()}function viewTindakan(a){for(var t="",e=0;e<a.length;e++)t+="<tr>",t+="<td>"+a[e].jenis_tarif+"</td>",t+="<td>"+a[e].keterangan_tindakan+"</td>",t+='<td><button class="btn btn-danger btn-xs" value="'+e+'" onclick="tindakanDel(this)">hapus</button></td>',t+="</tr>";$("#ajaxTindakan").html(t),$("#tindakan").val(JSON.stringify(dataTindakan));for(var t="",i=0,e=0;e<a.length;e++)a[e].biaya>0&&(t+="<tr>",t+="<td>"+a[e].jenis_tarif+"</td>",t+='<td class="uang">'+a[e].biaya+"</td>",t+="</tr>",i+=a[e].biaya);$("#dibayarTIndakanBpjs").html(t),$("#TotalDibayarTindakanBPJS").html(i),rupiah(),bpjsBayar()}function tindakanDel(a){var t=$(a).val();dataTindakan.splice(t,1),viewTindakan(dataTindakan),resetInputTIndakan(),optionBilaNebuBpjs()}function resetInputTIndakan(){$("#keteranganTindakan").val(""),$("#selectTindakan").val(null).selectpicker("refresh").closest("tr").find(".btn-white").focus()}function dirujuk(){$("#confirmRujuk").hide(),$("#infoRujuk").removeClass("hide").hide().slideDown(500),$("#tujuan_rujuk2").focus()}function tidakDirujuk(){clearRujuk(),$("#submitFormPeriksa").click()}function rujukanSelesai(){var a=$("#tujuan_rujuk2").val();""==a?validasi("#tujuan_rujuk2","Harus Diisi!"):($("#tujuan_rujuk").val($("#tujuan_rujuk2").val()),$("#alasan_rujuk").val($("#alasan_rujuk2").val()),$("#submitFormPeriksa").click())}function cancelRujukan(){$("#modal-id").modal("hide"),clearRujuk()}function serial(){}function clearRujuk(){$("#tujuan_rujuk").val(""),$("#alasan_rujuk").val("")}function tabResepActive(){namaObatFocus()}function diagnosaChange(){var a=$("#asuransi_id").val();$("#bb_input").val(),$("#ddlDiagnosa").val(),$("#staf_id").val();"32"==a&&$.post(base+"/poli/ajax/diagcha",{diagnosa_id:$("#ddlDiagnosa").val()},function(a){if(a=$.trim(a),"1"==a){if($("#keterangan_boleh_dirujuk").empty(),""!=$("#ddlDiagnosa").val()||null!=$("#ddlDiagnosa").val()){var t=$("#ddlDiagnosa option:selected").text(),e='<div class="alert alert-danger" id="isi_pesan_fornas">'+t+" <strong>tidak boleh DIRUJUK </strong> pilih diagnosa lain (menurut ICD10) bila pasien memang benar2 harus dirujuk</div>";$("#keterangan_boleh_dirujuk").prepend(e).hide().fadeIn(500)}}else $("#keterangan_boleh_dirujuk").empty()}),generate();var t="";""!=$("#ddlDiagnosa").val()&&(t=$("#ddlDiagnosa option:selected").text()),t.indexOf("J45")!=-1?($("#lblDiagnosa").attr({title:"Bila Asma Berat","data-original-title":"Bila Asma Berat","data-content":"Jika ASMA BERAT, berikan bersama dexa inj IV 2 ampul, dan prednison 40 tab hr 1-2 :3x3, hr 3-4 : 3x2, hr 5-7 : 3x1, Decafil 20 tablet, termasuk untuk pasien BPJS"}),$("#lblDiagnosa").popover("show")):$("#lblDiagnosa").popover("hide")}function namaObatFocus(){$("#ddlNamaObat").closest("div").find(".btn-white").focus()}function clearResep(){$("#terapi").val("[]"),data=[],viewResep(""),namaObatFocus()}function generatePerscription(){var a=temp_sop_terapi;i_sop_terapi+=1;var t=parseInt(i_sop_terapi)+1,e=a[i_sop_terapi].terapi;e=JSON.stringify(e),t==length_sop_terapi&&(i_sop_terapi=-1),data=JSON.parse(e),$("#terapi").val(e),viewResep(resepJson(e)[1]),$("#tampungan_sop_terapi").html(t+"/"+length_sop_terapi)}function viewResep(a){if($("#ajax5").html(a),$("#plafon").length>0){var t=0,e=$("#terapi").val();e=JSON.parse(e);for(var i=0,n=0;n<e.length;n++)i=e[n].harga_jual_ini,t+=i*e[n].jumlah*$("#kali_obat").val();var r=$("#plafon_total").val()-t;$("#plafon").html(r),r<0?($("#uangKekuranganFlat").html(rataAtas5000(Math.abs(r))),$("#kekuranganFlat").hasClass("hide")&&$("#kekuranganFlat").removeClass("hide")):$("#kekuranganFlat").hasClass("hide")||$("#kekuranganFlat").addClass("hide")}if($("#bilaTipeBPJS").length>0){for(var d="",l=0,s=0,n=0;n<data.length;n++)"0"==data[n].fornas&&(s=data[n].harga_jual_ini*data[n].jumlah*$("#kali_obat").val(),l+=s,d+="<tr>",d+="<td>"+data[n].merek_obat+"</td>",d+="<td>"+data[n].jumlah+"</td>",d+="</tr>");l=rataAtas5000(l),$("#bilaTipeBPJS").html(d),$("#totalBilaTipeBPJS").html(l),rupiah(),bpjsBayar()}$("#peringatan").empty()}function generate(){var a={asuransi_id:$("#asuransi_id").val(),berat_badan:$("#bb_input").val(),diagnosa_id:$("#ddlDiagnosa").val(),staf_id:$("#staf_id").val(),_token:$("#token").val()},t=$("#terapi").val();"1"==$("#hamil").val()||"1"!=$("#dibantu").val()||""!=t&&"[]"!=t||$.post(base+"/poli/ajax/sopterapi",a,function(a){a=$.trim(a);var t=JSON.parse(a);if(temp_sop_terapi=t,length_sop_terapi=t.length,t[0]){var e=t[0].terapi;e=JSON.stringify(e),data=JSON.parse(e),$("#terapi").val(e),viewResep(resepJson(e)[1]),$("#tampungan_sop_terapi").html("1/"+length_sop_terapi),i_sop_terapi=0}else{var e="[]";$("#terapi").val(e),viewResep(resepJson(e)[1]),temp_sop_terapi=[],$("#tampungan_sop_terapi").html("0"),i_sop_terapi=0}}).fail(function(a){var t=$.parseJSON(a.responseText);$.each(t,function(a,t){$.gritter.add({title:"Error",text:t})})})}function generate2(){var a={asuransi_id:$("#asuransi_id").val(),berat_badan:$("#bb_input").val(),diagnosa_id:$("#ddlDiagnosa").val(),staf_id:$("#staf_id").val(),_token:$("#token").val()};$("#terapi").val();"1"!=$("#hamil").val()&&"1"==$("#dibantu").val()&&$.post(base+"/poli/ajax/sopterapi",a,function(a){a=$.trim(a);var t=JSON.parse(a);if(temp_sop_terapi=t,length_sop_terapi=t.length,t[0]){var e=t[0].terapi;e=JSON.stringify(e),data=JSON.parse(e),$("#terapi").val(e),viewResep(resepJson(e)[1]),$("#tampungan_sop_terapi").html("1/"+length_sop_terapi),i_sop_terapi=0}else{var e="[]";$("#terapi").val(e),viewResep(resepJson(e)[1]),temp_sop_terapi=[],$("#tampungan_sop_terapi").html("0"),i_sop_terapi=0}})}function hasil(){var a=$("#usg_presentasi").val(),t="",e=$("#usg_sex").val(),i=$("#usg_plasenta").val(),n=$("#usg_ltp").val(),r=$("#uk").val(),d=$("#usg_efw").val(),l=$("#usg_djj").val(),s="G"+$("#G").val()+"P"+$("#P").val()+"A"+$("#A").val(),o=$("#total_afi").val(),u="",p=$.trim(r.split("minggu")[0]);p>=12&&p<=24?u=$("#BPD_w").val()+" minggu "+$("#BPD_d").val()+" hari":p>=24&&(u=$("#FL_w").val()+" minggu "+$("#FL_d").val()+" hari");var m="cukup";parseInt(o)>8?(m="berlebihan",t+="polihydramnion, "):parseInt(o)<2&&(m="kurang",t+="oligohydramnion, ");var c="normal";parseInt(l)>160?(c="tinggi",t+="takikardia fungsional dd/ Gawat Janin, "):parseInt(l)<120&&(c="rendah",t+="Gawat Janin, "),"0"==n&&(n="tidak ada");var g="Janin presentasi "+a+", denyut jantung janin "+c+" "+l+" x/mnt, "+n+" lilitan tali pusat, perikiraan berat janin "+d+" gr";g+=", umur kehamilan menurut USG saat ini = "+u,g+=", jenis kelamin "+e+", plasenta di "+i+", cairan ketuban 1 kantong terdalam "+o+", "+m+", "+s+"H"+r+", Janin presentasi "+a+", "+t;var h="4 minggu lagi";p>=37?h="1 minggu lagi":p>=32&&(h="2 minggu lagi"),$("#saran").val("periksa lagi "+h),$("#kesimpulan").val(g)}function riwObsG(){if(""!=$("#G").val()&&$("#G").val()<10){var a=$("#pasien_id").val();$.post(base+"/anc/registerhamil",{G:$("#G").val(),pasien_id:a},function(a,t,e){if(""!=a){if(null!=a.buku)var i=a.buku.id;else var i=3;$("#hpht").val(a.hpht),$("#uk").val(a.uk),$("#P").val(a.p),$("#A").val(a.a),$("#tanggal_lahir_anak_terakhir").val(a.tanggal_lahir_anak_terakhir),$("#golongan_darah").val(a.golongan_darah),$("#rencana_penolong").val(a.rencana_penolong),$("#rencana_tempat").val(a.rencana_tempat),$("#rencana_pendamping").val(a.rencana_pendamping),$("#rencana_transportasi").val(a.rencana_transportasi),$("#rencana_pendonor").val(a.rencana_pendonor),$("#tb").val(a.tb),$("#jumlah_janin").val(a.jumlah_janin),$("#status_imunisasi_tt_id").val(a.status_imunisasi_tt_id),$("#nama_suami").val(a.nama_suami),$("#buku").val(i),$("#bb_sebelum_hamil").val(a.bb_sebelum_hamil),$("#riwayat_kehamilan").val(a.riwayat_kehamilan_sebelumnya),uk_exec("uk","hpht"),viewNoFocus()}})}else $(".gpa2").val(""),$(".panelRiwayat").val(""),$("#riwayat_kehamilan").val("[]"),viewNoFocus()}function fokusKeAnemnesa(){$("#cekFoto").modal("hide"),$("#cekFoto").on("hidden.bs.modal",function(a){$("#anamnesa").focus(),$("#labelKecelakaanKerja").on("shown.bs.popover",function(){setTimeout(function(){$("#labelKecelakaanKerja").popover("hide")},8e3)}),$("#labelKecelakaanKerja").popover("show")})}function showFotoZoom(){$("#fotozoom").modal("show")}function rupiah(){$('.uang:not(:contains("Rp."))').each(function(){var a=$(this).html();a=a.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1."),$(this).html("Rp. "+a+" ,-")})}function kecelakaanKerjaChange(a){var t=$("#asuransi_id").val(),e=$(a).val(),i=$("#antrianperiksa_id").val();"32"==t&&"1"==e&&($("#pleaseWaitDialog").modal({backdrop:"static",keyboard:!1}),$.ajax({url:base+"/poli/ajax/kkchange",type:"POST",data:{antrianperiksa_id:i}}).done(function(){location.reload(!0)}).fail(function(){$("#pleaseWaitDialog").modal("hide")}))}function asuransiIdChange(a){var t=$(a).val(),e=$("#antrianperiksa_id").val();$("#pleaseWaitDialog").modal({backdrop:"static",keyboard:!1}),$.ajax({url:base+"/poli/ajax/asuridchange",type:"POST",data:{asuransi_id:t,antrianperiksa_id:e}}).done(function(){location.reload(!0)}).fail(function(){$("#pleaseWaitDialog").modal("hide")}).always(function(){})}function bpjsBayar(){var a=$("#asuransi_id").val();if("32"==a){var t=$("#TotalDibayarTindakanBPJS").html(),e=$("#totalBilaTipeBPJS").html();"Rp. ,-"==e&&(e="Rp. 0,-"),"Rp. ,-"==t&&(t="Rp. 0,-");var i=parseInt(cleanUang(t))+parseInt(cleanUang(e));$("#jumlahDibayarBpjs").html(i),i>0?$("#adaYangDibayar").hide().fadeIn(500):$("#adaYangDibayar").hide(),rupiah()}}function bukanAsmaAkut(){var a=!1;apakahAsmaAkut(a);var t="Tindakan BPJS pasien ini tidak ditanggung BPJS, karena bukan asma akut. Tekan pilihan di bawah ini untuk mengubah";updateKeteranganNebuBpjs(t,a)}function asmaAkut(){var a=!0;apakahAsmaAkut(a);var t="Nebulizer ditanggung BPJS karena asma akut. Tekan pilihan di bawah ini untuk mengubah ";updateKeteranganNebuBpjs(t,a)}function optionBilaNebuBpjs(){for(var a=tindakansArray(),t=!1,e=0;e<a.length;e++)if("102"==a[e].jenis_tarif_id||"103"==a[e].jenis_tarif_id){t=!0;break}t&&"32"==$("#asuransi_id").val()?$("#option_bila_nebu_bpjs").hide().fadeIn(500):$("#option_bila_nebu_bpjs").fadeOut(500)}function tindakansArray(){var a=$("#tindakan").val();return a=$.parseJSON(a)}function apakahAsmaAkut(a){if(a)var t="(ditanggung)",e=0,i=0;else var t=" (TIDAK DITANGGUNG BPJS)",e=45e3,i=4e4;for(var n=tindakansArray(),r=0;r<n.length;r++)if("102"==n[r].jenis_tarif_id||"103"==n[r].jenis_tarif_id){var t=n[r].keterangan,d=n[r].jenis_tarif_id;if(n.splice(r,1),"102"==d)var l={jenis_tarif_id:"102",jenis_tarif:"Nebulizer Anak "+t,biaya:e,keterangan_tindakan:t};else var l={jenis_tarif_id:"103",jenis_tarif:"Nebulizer Dewasa "+t,biaya:i,keterangan_tindakan:t};n[n.length]=l}var s=JSON.stringify(n);$("#tindakan").val(s)}function updateKeteranganNebuBpjs(a,t){$("#keterangan_nebu_bpjs").html(a);var e=$("#option_bila_nebu_bpjs");t?(e.hasClass("alert-danger")||e.hasClass("alert-warning"))&&(e.removeClass("alert-danger"),e.removeClass("alert-warning"),e.addClass("alert-success")):(e.hasClass("alert-warning")||e.hasClass("alert-success"))&&(e.removeClass("alert-success"),e.removeClass("alert-warning"),e.addClass("alert-danger")),$("#option_bila_nebu_bpjs").hide().fadeIn(500)}function bahanHabisPakai(){for(var a=dataTindakan,t="",e=0;e<a.length;e++)t+=a[e].jenis_tarif+" : "+a[e].keterangan_tindakan+", \n";var i=JSON.stringify(dataTindakan);$.post(base+"/poli/ajax/bhp_tindakan",{jsonData:i,_token:$("#token").val()},function(a,t,e){
var a=$.parseJSON(a);if(a.length>0){var i='<div class="alert alert-success">';i+='<h3 class="text-center">Daftar Bahan Habis Pakai Tindakan</h3>',i+='<table class="table table-condensed"><tbody>';for(var n=0,r=a.length;n<r;n++)i+="<tr>",i+='<td> R/ <a nowrap="" href="#" onclick="informasi(this); return false; " data-value="'+a[n].merek_id+'" data-toggle="modal" data-target=".bs-example-modal-lg">'+a[n].merek+"</a></td>",i+='<td class"text-right"> No : '+a[n].jumlah+"</td>",i+="</tr>";i+="</tbody></table>",i+='<p class="text-center">Tidak Perlu diinput lagi</p></div>',$("#bhp_tindakan").html(i)}else $("#bhp_tindakan").html("")}),$("#pemeriksaan_penunjang").val(t).focus()}function dummySubmit(){var a=$("#puyer").val(),t=$("#boolAdd").val(),e=$("#adatindakan").val(),i=$.parseJSON($("#tindakan").val());if("1"==t||"1"==a)return alert("Puyer atau Add Sirup belum selesai. Resep tidak bisa dilanjutkan sebelum diselesaikan"),!1;if("3"==$("#asuransi_id").val()&&("[]"==$("#terapi").val()||""==$("#terapi").val())){var n=confirm("Untuk peserta Inhealth, jika tidak ada terapi yang diberikan , maka bagi hasil untuk dokter tidak bisa dibayarkan untuk pasien ini, Apakah anda yakin ingin melanjutkan? karena anda akan tidak dibayar ntuk pasien ini tanpa terapi");if(!n)return alert("Kalau Bingung mau kasih obat apa untuk pasien ini, kasih saja vitamin 4 tablet. bisa pakai neurodex, atau therabex"),!1;alert("Anda telah menyetujui untuk tidak dibayar karena melayani pasien ini")}if(""==$("#anamnesa").val()||""==$("#ddlDiagnosa").val())return alert("Anamnesa dan Diagnosa tidak boleh dikosongkan!!"),$("#tab-status").tab("show"),""==$("#anamnesa").val()&&validasi("#anamnesa","Harus Diisi!"),""==$("#ddlDiagnosa").val()&&validasi2("#ddlDiagnosa","Harus Diisi!"),!1;if("1"==e){for(var r=0,d=0;d<i.length;d++)"1"!=i[d].jenis_tarif_id&&"9"!=i[d].jenis_tarif_id&&"140"!=i[d].jenis_tarif_id&&r++;if(0==r){var n=confirm("Apa Anda lupa isi kolom tindakan? Jika anda yakin bahwa tidak ada tindakan tambahan, tekan tombol OK");if(!n)return!1;$("#submitFormPeriksa").click()}else $("#submitFormPeriksa").click()}else $("#submitFormPeriksa").click()}function showFotoZoom(){$("#fotozoom").modal("show")}function resepJson(a){if(""!=a)var t=JSON.parse(a);else var t="";var e='<table width="100%">';if(t.length>0){for(var i=0;i<t.length-1;i++)"Puyer"==t[i].signa.substring(0,5)&&"0"==$("#puyer").val()?(e+="<tr>",e+='<td style="width:15px">R/</td>',e+='<td style="text-align:left; width:150px;" nowrap>'+t[i].merek_obat+" <strong>[  "+t[i].rak_id+"  ]</strong></td>",e+="<td> No : "+t[i].jumlah+"</td>",e+="</tr>",t[i].signa==t[i+1].signa?$("#puyer").val("1"):$("#puyer").val("0")):"Puyer"==t[i].signa.substring(0,5)&&"1"==$("#puyer").val()?(e+="<tr>",e+='<td style="width:15px"></td>',e+='<td style="text-align:left; width:150px;" nowrap>'+t[i].merek_obat+" <strong>[  "+t[i].rak_id+"  ]</strong></td>",e+="<td> No : "+t[i].jumlah+"</td>",e+="</tr>",t[i].signa==t[i+1].signa?$("#puyer").val("1"):$("#puyer").val("0")):t[i].merek_id==-1||t[i].merek_id==-3?(e+="<tr>",e+='<td style="width:15px"></td>',e+='<td style="width:150px;border-bottom:1px solid #000;" nowrap class="merek">Buat Menjadi '+t[i].jumlah+" puyer "+t[i].signa+"</td>",e+='<td style="border-bottom:1px solid #000;"  nowrap>'+t[i].aturan_minum+"</td>",e+="</tr>",$("#puyer").val("0")):"Add"==t[i].signa.substring(0,3)&&"0"==$("#boolAdd").val()?(e+="<tr>",e+='<td style="width:15px">R/</td>',e+='<td style="width:150px;text-align:left;" nowrap>'+t[i].merek_obat+" <strong>[  "+t[i].rak_id+"  ]</strong></td>",e+="<td> fls No : "+t[i].jumlah+"</td>",e+="</tr>",e+="<tr>",e+='<td style="text-align:center;" colspan="3">ADD</td>',e+="</tr>",$("#boolAdd").val("1")):"Add"==t[i].signa.substring(0,3)&&"1"==$("#boolAdd").val()?(e+="<tr>",e+='<td style="width:15px"></td>',e+='<td style="width:150px;text-align:left;" nowrap>'+t[i].merek_obat+" <strong>[  "+t[i].rak_id+"  ]</strong></td>",e+="<td> No : "+t[i].jumlah+"</td>",e+="</tr>",t[i].signa==t[i+1].signa?$("#boolAdd").val("1"):$("#boolAdd").val("0")):t[i].merek_id==-2?(e+="<tr>",e+='<td style="width:15px"></td>',e+='<td style="width:150px;border-bottom:1px solid #000;">S Masukkan ke dalam sirup '+t[i].signa+" </td>",e+='<td style="border-bottom:1px solid #000;">Dihabiskan</td>',e+="</tr>",$("#puyer").val("0")):(e+="<tr>",e+='<td style="width:15px">R/</td>',e+='<td style="width:150px;text-align:left;" nowrap>'+t[i].merek_obat+" <strong>[  "+t[i].rak_id+"  ]</strong></td>",e+="<td> No : "+t[i].jumlah+"</td>",e+="</tr><tr>",e+='<td style="width:15px"></td>',e+='<td style="width:150px;border-bottom:1px solid #000;"> S '+t[i].signa+"</td>",e+='<td style="border-bottom:1px solid #000;" nowrap>'+t[i].aturan_minum+"</td>",e+="</tr>");var n=t.length-1;t[n].merek_id==-1||t[n].merek_id==-3?(e+="<tr>",e+='<td style="width:15px"></td>',e+='<td style="width:150px;border-bottom:1px solid #000;" nowrap class="merek">Buat Menjadi '+t[n].jumlah+" puyer "+t[n].signa+"</td>",e+='<td style="border-bottom:1px solid #000;" nowrap>'+t[n].aturan_minum+"</td>",$("#puyer").val("0")):t[n].merek_id==-2?(e+="<tr>",e+='<td style="width:15px"></td>',e+='<td style="width:150px;border-bottom:1px solid #000;" >S Masukkan ke dalam sirup '+t[n].signa+"</td>",e+='<td style="border-bottom:1px solid #000;">Dihabiskan</td>',$("#boolAdd").val("0")):"Add"==t[n].signa.substring(0,3)&&"0"==$("#boolAdd").val()?(e+="<tr>",e+='<td style="width:15px">R/</td>',e+='<td style="width:150px;" nowrap>'+t[n].merek_obat+" <strong>[  "+t[n].rak_id+"  ]</strong></td>",e+="<td> fls No : "+t[n].jumlah+"</td>",e+="</tr>",e+="<tr>",e+='<td  style="text-align:center;" colspan="3">ADD</td>',$("#boolAdd").val("1"),id_formula_sirup_add=t[n].formula_id):"Add"==t[n].signa.substring(0,3)&&"1"==$("#boolAdd").val()?(e+="<tr>",e+='<td style="width:15px"></td>',e+='<td style="width:150px;" nowrap>'+t[n].merek_obat+" <strong>[  "+t[n].rak_id+"  ]</strong></td>",e+="<td> No : "+t[n].jumlah+"</td>","150802040"==t[n].formula_id&&"150803008"==id_formula_sirup_add||"150806007"==t[n].formula_id&&"150803003"==id_formula_sirup_add||"150803047"==t[n].formula_id&&"150803006"==id_formula_sirup_add||"150806005"==t[n].formula_id&&"150921001"==id_formula_sirup_add||(addSatu=!0)):"Puyer"==t[n].signa.substring(0,5)&&"0"==$("#puyer").val()?(e+="<tr>",e+='<td style="width:15px">R/</td>',e+='<td style="width:150px;text-align:left;" nowrap>'+t[n].merek_obat+" <strong>[  "+t[n].rak_id+"  ]</strong></td>",e+="<td> No : "+t[n].jumlah+"</td>"):"Puyer"==t[n].signa.substring(0,5)&&"1"==$("#puyer").val()?(e+="<tr>",e+='<td style="width:15px"></td>',e+='<td style="width:150px;text-align:left;" nowrap>'+t[n].merek_obat+" <strong>[  "+t[n].rak_id+"  ]</strong></td>",e+="<td> No : "+t[n].jumlah+"</td>"):(e+="<tr>",e+='<td style="width:15px">R/</td>',e+='<td style="width:150px;text-align:left;" nowrap>'+t[n].merek_obat+" <strong>[  "+t[n].rak_id+"  ]</strong></td>",e+="<td> No : "+t[n].jumlah+"</td>",e+="</tr><tr>",e+='<td style="width:15px"></td>',e+='<td style="width:150px;border-bottom:1px solid #000;"> S '+t[n].signa+"</td>",e+='<td style="border-bottom:1px solid #000;" nowrap>'+t[n].aturan_minum+"</td>")}e+="</tr></table>",$("#puyer").val("0"),$("#boolAdd").val("0");var r='<table class="RESEP table table-condensed"><tbody>',d=[];if(t.length>0){for(var i=0;i<t.length-1;i++)"Puyer"==t[i].signa.substring(0,5)&&"0"==$("#puyer").val()?(d=[],d[d.length]={id:i},r+="<tr>",r+='<td style="width:15px">R/</td>',r+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[i].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[i].merek_obat+"</a></t[d>  ",r+="<td>   No : "+t[i].jumlah+"</td>",r+='<td class="displayNone">'+t[i].merek_id+"</td>",r+="<td></td>",r+="</tr>",t[i].signa==t[i+1].signa?$("#puyer").val("1"):$("#puyer").val("0")):"Puyer"==t[i].signa.substring(0,5)&&"1"==$("#puyer").val()?(d[d.length]={id:i},r+="<tr>",r+='<td style="width:15px"></td>',r+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[i].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[i].merek_obat+"</a></t[d>  ",r+="<td>   No : "+t[i].jumlah+"</td>",r+='<td class="displayNone">'+t[i].merek_id+"</td>",r+="<td></td>",r+="</tr>",t[i].signa==t[i+1].signa?$("#puyer").val("1"):$("#puyer").val("0")):t[i].merek_id==-1||t[i].merek_id==-3?(d[d.length]={id:i},r+="<tr>",r+='<td style="width:15px"></td>',r+='<td style="border-bottom:1px solid #000;" nowrap class="merek" >Buat Menjadi '+t[i].jumlah+" puyer "+t[i].signa+"</td>",r+='<td style="border-bottom:1px solid #000;" nowrap>'+t[i].aturan_minum+"</td>",r+="<td><button class='btn btn-danger btn-sm' onclick='rowdel(this)' type='button' value='"+JSON.stringify(d)+"'>hapus</button></td>",r+='<td class="displayNone">'+t[i].merek_id+"</td>",r+="</tr>",$("#puyer").val("0")):"Add"==t[i].signa.substring(0,3)&&"0"==$("#boolAdd").val()?(d=[],d[d.length]={id:i},r+="<tr>",r+='<td style="width:15px">R/</td>',r+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[i].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[i].merek_obat+"</a></t[d>",r+="<td> fls No : "+t[i].jumlah+"</td>",r+='<td class="displayNone">'+t[i].merek_id+"</td>",r+="<td></td>",r+="</tr>",r+="<tr>",r+='<td  style="text-align:center;" colspan="3">ADD</td>',r+='<td class="displayNone"></td>',r+="<td></td>",r+="</tr>",id_formula_sirup_add=t[i].formula_id,addSatu=!1,$("#boolAdd").val("1")):"Add"==t[i].signa.substring(0,3)&&"1"==$("#boolAdd").val()?(d[d.length]={id:i},r+="<tr>",r+='<td style="width:15px"></td>',r+='<td style="text-align:left;"><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[i].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[i].merek_obat+"</a></t[d>  ",r+="<td>   No : "+t[i].jumlah+"</td>",r+='<td class="displayNone">'+t[i].merek_id+"</td>",r+="<td></td>",r+="</tr>","150802040"==t[n].formula_id&&"150803008"==id_formula_sirup_add||"150806007"==t[n].formula_id&&"150803003"==id_formula_sirup_add||"150803047"==t[n].formula_id&&"150803006"==id_formula_sirup_add||"150806005"==t[n].formula_id&&"150921001"==id_formula_sirup_add||(addSatu=!0),t[i].signa==t[i+1].signa?$("#boolAdd").val("1"):$("#boolAdd").val("0")):t[i].merek_id==-2?(d[d.length]={id:i},r+="<tr>",r+='<td style="width:15px"></td>',r+='<td style="border-bottom:1px solid #000;" >S Masukkan ke dalam sirup '+t[i].signa+"</td>",r+='<td style="border-bottom:1px solid #000;">Dihabiskan</td>',r+="<td><button class='btn btn-danger btn-sm' onclick='rowdel(this)' type='button' value='"+JSON.stringify(d)+"'>hapus</button></td>",r+='<td class="displayNone"></td>',r+="</tr>",$("#puyer").val("0")):(d=[],d[d.length]={id:i},r+="<tr>",r+='<td style="width:15px">R/</td>',r+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[i].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[i].merek_obat+"</a></t[d>  ",r+="<td>   No : "+t[i].jumlah+"</td>",r+='<td class="displayNone">'+t[i].merek_id+"</td>",r+="<td></td>",r+="</tr><tr>",r+='<td style="width:15px"></td>',r+='<td style="border-bottom:1px solid #000;"> S '+t[i].signa+"</td>",r+='<td style="border-bottom:1px solid #000;" nowrap>'+t[i].aturan_minum+"</td>",r+='<td class="displayNone"></td>',r+="<td><button class='btn btn-danger btn-sm' onclick='rowdel(this)' type='button' value='"+JSON.stringify(d)+"'>hapus</button></td>",r+="</tr>");var n=t.length-1;t[n].merek_id==-1||t[n].merek_id==-3?(d=[],d[d.length]={id:n},r+="<tr>",r+='<td style="width:15px"></td>',r+='<td style="border-bottom:1px solid #000;" nowrap class="merek" >Buat Menjadi '+t[n].jumlah+" puyer "+t[n].signa+"</td>",r+='<td style="border-bottom:1px solid #000;" nowrap>'+t[n].aturan_minum+"</td>",r+="<td><button class='btn btn-danger btn-sm' onclick='rowdel(this)' type='button' value='"+JSON.stringify(d)+"'>hapus</button></td>",r+='<td class="displayNone"></td>',r+="<td></td>",$("#puyer").val("0")):t[n].merek_id==-2?(d=[],d[d.length]={id:n},r+="<tr>",r+='<td style="width:15px"></td>',r+='<td style="border-bottom:1px solid #000;">S Masukkan ke dalam sirup '+t[n].signa+"</td>",r+='<td style="border-bottom:1px solid #000;">Dihabiskan</td>',r+="<td><button class='btn btn-danger btn-sm' onclick='rowdel(this)' type='button' value='"+JSON.stringify(d)+"'>hapus</button></td>",r+='<td class="displayNone"></td>',$("#boolAdd").val("0")):"Add"==t[n].signa.substring(0,3)&&"0"==$("#boolAdd").val()?(d=[],d[d.length]={id:n},r+="<tr>",r+='<td style="width:15px">R/</td>',r+='<td><a data-target=".bs-example-modal-lg" data-toggle="modal" value="'+t[n].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[n].merek_obat+"</a></td>",r+="<td> fls No : "+t[n].jumlah+"</td>",r+='<td class="displayNone">'+t[n].merek_id+"</td>",r+="<td></td>",r+="</tr>",r+="<tr>",r+='<td  style="text-align:center;" colspan="3">ADD</td>',r+="<td><button class='btn btn-danger btn-sm' onclick='rowdel(this)' type='button' value='"+JSON.stringify(d)+"'>hapus</button></td>",r+='<td class="displayNone"></td>',$("#boolAdd").val("1")):"Add"==t[n].signa.substring(0,3)&&"1"==$("#boolAdd").val()?(d=[],d[d.length]={id:n},r+="<tr>",r+='<td style="width:15px"></td>',r+='<td><a data-target=".bs-example-modal-lg" data-toggle="modal" value="'+t[n].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[n].merek_obat+"</a></td>",r+="<td> No : "+t[n].jumlah+"</td>",r+="<td><button class='btn btn-danger btn-sm' onclick='rowdel(this)' type='button' value='"+JSON.stringify(d)+"'>hapus</button></td>",r+='<td class="displayNone">'+t[n].merek_id+"</td>","150802040"==t[n].formula_id&&"150803008"==id_formula_sirup_add||"150806007"==t[n].formula_id&&"150803003"==id_formula_sirup_add||"150803047"==t[n].formula_id&&"150803006"==id_formula_sirup_add||"150806005"==t[n].formula_id&&"150921001"==id_formula_sirup_add||(addSatu=!0)):"Puyer"==t[n].signa.substring(0,5)&&"0"==$("#puyer").val()?(d=[],d[d.length]={id:n},r+="<tr>",r+='<td style="width:15px">R/</td>',r+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[n].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[n].merek_obat+"</a></td>",r+="<td> No : "+t[n].jumlah+"</td>",r+="<td><button class='btn btn-danger btn-sm' onclick='rowdel(this)' type='button' value='"+JSON.stringify(d)+"'>hapus</button></td>",r+='<td class="displayNone">'+t[n].merek_id+"</td>",$("#puyer").val("1")):"Puyer"==t[n].signa.substring(0,5)&&"1"==$("#puyer").val()?(d=[],d[d.length]={id:n},r+="<tr>",r+='<td style="width:15px"></td>',r+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[n].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[n].merek_obat+"</a></td>",r+="<td> No : "+t[n].jumlah+"</td>",r+="<td><button class='btn btn-danger btn-sm' onclick='rowdel(this)' type='button' value='"+JSON.stringify(d)+"'>hapus</button></td>",r+='<td class="displayNone">'+t[n].merek_id+"</td>"):(d=[],d[d.length]={id:n},r+="<tr>",r+='<td style="width:15px">R/</td>',r+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[n].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[n].merek_obat+"</a></td>",r+="<td> No : "+t[n].jumlah+"</td>",r+='<td class="displayNone">'+t[n].merek_id+"</td>",r+="<td></td>",r+="</tr><tr>",r+='<td style="width:15px"></td>',r+='<td style="border-bottom:1px solid #000;"> S '+t[n].signa+"</td>",r+='<td style="border-bottom:1px solid #000;" nowrap>'+t[n].aturan_minum+"</td>",r+="<td><button class='btn btn-danger btn-sm' onclick='rowdel(this)' type='button' value='"+JSON.stringify(d)+"'>hapus</button></td>",r+='<td class="displayNone"></td>'),r+="</tr></tbody></table>"}else r="",e="";$("#puyer").val("0"),$("#boolAdd").val("0");var l='<table class="RESEP table table-condensed"><tbody>',d=[];if(t.length>0){for(var i=0;i<t.length-1;i++)"Puyer"==t[i].signa.substring(0,5)&&"0"==$("#puyer").val()?(d=[],d[d.length]={id:i},l+="<tr>",l+='<td style="width:15px">R/</td>',l+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[i].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[i].merek_obat+"</a></t[d>  ",l+="<td>   No : "+t[i].jumlah+"</td>",l+='<td class="displayNone">'+t[i].merek_id+"</td>",l+="</tr>",t[i].signa==t[i+1].signa?$("#puyer").val("1"):$("#puyer").val("0")):"Puyer"==t[i].signa.substring(0,5)&&"1"==$("#puyer").val()?(d[d.length]={id:i},l+="<tr>",l+='<td style="width:15px"></td>',l+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[i].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[i].merek_obat+"</a></t[d>  ",l+="<td>   No : "+t[i].jumlah+"</td>",l+='<td class="displayNone">'+t[i].merek_id+"</td>",l+="</tr>",t[i].signa==t[i+1].signa?$("#puyer").val("1"):$("#puyer").val("0")):t[i].merek_id==-1||t[i].merek_id==-3?(d[d.length]={id:i},l+="<tr>",l+='<td style="width:15px"></td>',l+='<td style="border-bottom:1px solid #000;" nowrap class="merek" >Buat Menjadi '+t[i].jumlah+" puyer "+t[i].signa+"</td>",l+='<td style="border-bottom:1px solid #000;" nowrap>'+t[i].aturan_minum+"</td>",l+='<td class="displayNone">'+t[i].merek_id+"</td>",l+="</tr>",$("#puyer").val("0")):"Add"==t[i].signa.substring(0,3)&&"0"==$("#boolAdd").val()?(d=[],d[d.length]={id:i},l+="<tr>",l+='<td style="width:15px">R/</td>',l+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[i].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[i].merek_obat+"</a></t[d>",l+="<td> fls No : "+t[i].jumlah+"</td>",l+='<td class="displayNone">'+t[i].merek_id+"</td>",l+="</tr>",l+="<tr>",l+='<td  style="text-align:center;" colspan="3">ADD</td>',l+='<td class="displayNone"></td>',l+="</tr>",id_formula_sirup_add=t[i].formula_id,addSatu=!1,$("#boolAdd").val("1")):"Add"==t[i].signa.substring(0,3)&&"1"==$("#boolAdd").val()?(d[d.length]={id:i},l+="<tr>",l+='<td style="width:15px"></td>',l+='<td style="text-align:left;"><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[i].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[i].merek_obat+"</a></t[d>  ",l+="<td>   No : "+t[i].jumlah+"</td>",l+='<td class="displayNone">'+t[i].merek_id+"</td>",l+="</tr>","150802040"==t[n].formula_id&&"150803008"==id_formula_sirup_add||"150806007"==t[n].formula_id&&"150803003"==id_formula_sirup_add||"150803047"==t[n].formula_id&&"150803006"==id_formula_sirup_add||"150806005"==t[n].formula_id&&"150921001"==id_formula_sirup_add||(addSatu=!0),t[i].signa==t[i+1].signa?$("#boolAdd").val("1"):$("#boolAdd").val("0")):t[i].merek_id==-2?(d[d.length]={id:i},l+="<tr>",l+='<td style="width:15px"></td>',l+='<td style="border-bottom:1px solid #000;" >S Masukkan ke dalam sirup '+t[i].signa+"</td>",l+='<td style="border-bottom:1px solid #000;">Dihabiskan</td>',l+='<td class="displayNone"></td>',l+="</tr>",$("#puyer").val("0")):(d=[],d[d.length]={id:i},l+="<tr>",l+='<td style="width:15px">R/</td>',l+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[i].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[i].merek_obat+"</a></t[d>  ",l+="<td>   No : "+t[i].jumlah+"</td>",l+='<td class="displayNone">'+t[i].merek_id+"</td>",l+="</tr><tr>",l+='<td style="width:15px"></td>',l+='<td style="border-bottom:1px solid #000;"> S '+t[i].signa+"</td>",l+='<td style="border-bottom:1px solid #000;" nowrap>'+t[i].aturan_minum+"</td>",l+='<td class="displayNone"></td>',l+="</tr>");var n=t.length-1;t[n].merek_id==-1||t[n].merek_id==-3?(d=[],d[d.length]={id:n},l+="<tr>",l+='<td style="width:15px"></td>',l+='<td style="border-bottom:1px solid #000;" nowrap class="merek" >Buat Menjadi '+t[n].jumlah+" puyer "+t[n].signa+"</td>",l+='<td style="border-bottom:1px solid #000;" nowrap>'+t[n].aturan_minum+"</td>",l+='<td class="displayNone"></td>',$("#puyer").val("0")):t[n].merek_id==-2?(d=[],d[d.length]={id:n},l+="<tr>",l+='<td style="width:15px"></td>',l+='<td style="border-bottom:1px solid #000;">S Masukkan ke dalam sirup '+t[n].signa+"</td>",l+='<td style="border-bottom:1px solid #000;">Dihabiskan</td>',l+='<td class="displayNone"></td>',$("#boolAdd").val("0")):"Add"==t[n].signa.substring(0,3)&&"0"==$("#boolAdd").val()?(d=[],d[d.length]={id:n},l+="<tr>",l+='<td style="width:15px">R/</td>',l+='<td><a data-target=".bs-example-modal-lg" data-toggle="modal" value="'+t[n].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[n].merek_obat+"</a></td>",l+="<td> fls No : "+t[n].jumlah+"</td>",l+='<td class="displayNone">'+t[n].merek_id+"</td>",l+="</tr>",l+="<tr>",l+='<td  style="text-align:center;" colspan="3">ADD</td>',l+='<td class="displayNone"></td>',$("#boolAdd").val("1")):"Add"==t[n].signa.substring(0,3)&&"1"==$("#boolAdd").val()?(d=[],d[d.length]={id:n},l+="<tr>",l+='<td style="width:15px"></td>',l+='<td><a data-target=".bs-example-modal-lg" data-toggle="modal" value="'+t[n].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[n].merek_obat+"</a></td>",l+="<td> No : "+t[n].jumlah+"</td>",l+='<td class="displayNone">'+t[n].merek_id+"</td>","150802040"==t[n].formula_id&&"150803008"==id_formula_sirup_add||"150806007"==t[n].formula_id&&"150803003"==id_formula_sirup_add||"150803047"==t[n].formula_id&&"150803006"==id_formula_sirup_add||"150806005"==t[n].formula_id&&"150921001"==id_formula_sirup_add||(addSatu=!0)):"Puyer"==t[n].signa.substring(0,5)&&"0"==$("#puyer").val()?(d=[],d[d.length]={id:n},l+="<tr>",l+='<td style="width:15px">R/</td>',l+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[n].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[n].merek_obat+"</a></td>",l+="<td> No : "+t[n].jumlah+"</td>",l+='<td class="displayNone">'+t[n].merek_id+"</td>",$("#puyer").val("1")):"Puyer"==t[n].signa.substring(0,5)&&"1"==$("#puyer").val()?(d=[],d[d.length]={id:n},l+="<tr>",l+='<td style="width:15px"></td>',l+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[n].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[n].merek_obat+"</a></td>",l+="<td> No : "+t[n].jumlah+"</td>",l+='<td class="displayNone">'+t[n].merek_id+"</td>"):(d=[],d[d.length]={id:n},l+="<tr>",l+='<td style="width:15px">R/</td>',l+='<td style="text-align:left;" ><a data-target=".bs-example-modal-lg" data-toggle="modal" data-value="'+t[n].merek_id+'" onclick="informasi(this); return false; " href="#" nowrap>'+t[n].merek_obat+"</a></td>",l+="<td> No : "+t[n].jumlah+"</td>",l+='<td class="displayNone">'+t[n].merek_id+"</td>",l+="</tr><tr>",l+='<td style="width:15px"></td>',l+='<td style="border-bottom:1px solid #000;"> S '+t[n].signa+"</td>",l+='<td style="border-bottom:1px solid #000;" nowrap>'+t[n].aturan_minum+"</td>",l+='<td class="displayNone"></td>'),l+="</tr></tbody></table>"}else r="",l="",e="";return[e,r,l]}function informasi(a){var t=$(a).data("value");$.post(base+"/poli/ajax/ajxobat",{merek_id:t},function(t){t=$.parseJSON(t);var e=t.komposisis,i="";if(e.length>0)for(var n=0;n<e.length;n++)i+="<tr>",i+="<td>"+e[n].komposisi+"</td>",i+="<td>"+e[n].pregnancy_safety_index+"</td>",i+="</tr>";else i+="<tr>",i+='<td colspan="2" class="text-center">Komposisi Tidak Terdaftar</td>',i+="</tr>";$("#nama_obat").text($(a).text()),$("#kontraindikasi").html(t.kontraindikasi),$("#indikasi").html(t.indikasi),$("#efek_samping").html(t.efek_samping),$("#tabel_komposisi").html(i)})}function inputRiwayatKehamilan(a){var t=riwayat_obs();if(""!=$("#inputSpontanSC").val()){var e=$("#inputJenisKelamin").val(),i=$("#inputBeratLahir").val(),n=$("#inputTahunLahir").val(),r=$("#inputLahirDi").val(),d=$("#inputSpontanSC").val();t[t.length]={jenis_kelamin:e,berat_lahir:i+" gr",tahun_lahir:n,lahir_di:r,spontan_sc:d},string_obs(t),view()}else validasi("#inputSpontanSC","Hapus Diisi!!")}function rowDel(a){riwayat=riwayat_obs();var t=$(a).closest("tr").find("td:first-child");t=parseInt(t)-1,riwayat.splice(t,1),string_obs(riwayat),view()}function viewNoFocus(){var a="";riwayat=riwayat_obs();for(var t=0;t<riwayat.length;t++){n=parseInt(t)+1;var e=parseInt(riwayat.length)-1;a+="<tr>",a+="<td>"+n+"</td>",a+="<td>"+riwayat[t].jenis_kelamin+"</td>",a+="<td>"+riwayat[t].berat_lahir+"</td>",a+="<td>"+riwayat[t].tahun_lahir+"</td>",a+="<td>"+riwayat[t].lahir_di+"</td>",a+="<td>"+riwayat[t].spontan_sc+"</td>",a+=t==e?'<td><button type="button" class="btn btn-danger btn-xs" onclick="rowDel(this);return false;">hapus</button></td>':"<td></td>",a+="</tr>"}var i=parseInt(riwayat.length)+1;a+="<tr>",a+="<td>"+i+"</td>",a+="<td>ini<td>",a+="<td></td>",a+="<td></td>",a+="<td></td>",a+="<td></td>",a+="<td></td>",a+="</tr>",$(".inp").val(""),$("#table_riwayat_kehamilan").html(a);var r=JSON.stringify(riwayat);$("#riwayat_kehamilan").val(r)}function view(){viewNoFocus(),$("#inputJenisKelamin").focus()}function riwayat_obs(){return riwayat=$("#riwayat_kehamilan").val(),""==riwayat&&(riwayat="[]"),JSON.parse(riwayat)}function string_obs(a){a=JSON.stringify(a),$("#riwayat_kehamilan").val(a)}function uk(a,t){$("#"+t).datepicker({todayBtn:"linked",keyboardNavigation:!1,forceParse:!1,calendarWeeks:!0,autoclose:!0,format:"dd-mm-yyyy"}).on("changeDate",function(e){uk_exec(a,t)}),$("#"+a).attr("readonly","readonly")}function uk_exec(a,t){if(""!=$("#"+t).val()){var e=$("#"+t).val();$.post(base+"/anc/uk",{hpht:e},function(t){t=$.trim(t),$("#"+a).val(t)})}else $("#"+a).val("")}var addSatu=!1,id_formula_sirup_add="",gen_presc_index=0,gen_presc_json="",total_afi_count=0,temp_sop_terapi=[],length_sop_terapi="",i_sop_terapi=0;if($("#LinkButton2").on("click",function(){validasiKeterangan()}),""==$("#terapi").val()||"[]"==$("#terapi").val())var data=[];else{var data=JSON.parse($("#terapi").val());viewResep(resepJson($("#terapi").val())[1])}if(""==$("#tindakan").val()||"[]"==$("#tindakan").val())var dataTindakan=[];else{var dataTindakan=JSON.parse($("#tindakan").val());viewTindakan(dataTindakan)}$("#dummy_submit_perujuk_baru").click(function(){var a=$("#nama_perujuk").val(),t=$("#alamat_perujuk").val(),e=$("#no_telp_perujuk").val();""==a||""==t||""==e?(""==a&&validasi("#nama_perujuk","harus diisi!!"),""==t&&validasi("#alamat_perujuk","harus diisi!!"),""==e&&validasi("#no_telp_perujuk","harus diisi!!")):$("#submit_perujuk_baru").click()}),$("#submit_perujuk_baru").click(function(){var a=$("#nama_perujuk").val(),t=$("#alamat_perujuk").val(),e=$("#no_telp_perujuk").val();$.post(base+"/perujuks/ajax/create",{nama:a,alamat:t,no_telp:e},function(t){"1"==t.result?($("#perujuk_id").html(t.options).val(t.value).selectpicker("refresh"),alert("perujuk baru bernama "+a+" telah berhasil ditambahkan"),$("#modal_buat_perujuk_baru").modal("hide")):(alert("maaf !! perujuk telah gagal ditambahkan"),$("#modal_buat_perujuk_baru").modal("hide"))})}),jQuery(document).ready(function(a){var t=a("#notified").val();"0"==t&&"32"==a("#asuransi_id").val()&&alert("Harap baca dengan Jelas aturan mengenai asuransi ini, ada satu / beberapa hal yang sudah ditambahkan. Terima kasih"),a("#modal_buat_perujuk_baru").on("shown.bs.modal",function(){a("#nama_perujuk").focus()}),a("#modal_buat_perujuk_baru").on("hidden.bs.modal",function(){a("#perujuk_id").closest("div").find(".btn-white").focus()}),bahanHabisPakai(),""!=a("#resepluar").val()&&a("#panel-resepluar").show(),a("#cekFoto").modal({backdrop:"static",keyboard:!1}),uk_exec("uk","hpht"),""==a("#kesimpulan").val()&&hasil(),riwObsG(),a(".hasil").on("keyup change",function(a){hasil()}),a("#G").keyup(function(a){riwObsG()}),view(),uk("umur_kehamilan","HPHT"),uk("uk","hpht"),a("#tab-status").on("shown.bs.tab",function(t){a("#anamnesa").focus()}),a("#usg_presentasi").blur(function(t){a(this).val().indexOf("kepala")>-1?a(".presentasi").val("2"):a(this).val().indexOf("lintang")>-1?a(".presentasi").val("3"):a(this).val().indexOf("bokong")>-1&&a(".presentasi").val("4")}),a("#usg_djj").blur(function(t){a("#djj").val(a(this).val())}),a("#tab-usg").on("shown.bs.tab",function(t){a("#usg_presentasi").focus()}),a("#tab-resep").on("shown.bs.tab",function(t){namaObatFocus();var e=a("#anamnesa").val(),i=a("#pemeriksaan_fisik").val();if(""!=e||""!=i){var n='<div class="alert alert-warning">';n+=e+" | "+i,n+="</div>"}a("#resume").html(n)}),a("#keterangan_diagnosa").keypress(function(t){var e=t.keyCode||t.which;9==e&&a("#tab-resep").tab("show")}),a("#modalTindakan").on("shown.bs.modal",function(){a("#selectTindakan").closest("td").find(".btn-white").focus()}),a("#btn_auto").click(function(t){if(""==a("#bb_input").val())var e="55";else var e=a("#bb_input").val();a("#bb_aktif").val(e);var i=a("#bb_aktif").val();a("#berat_badan").val(i),a.get(base+"/DdlMerek/alloption2",{bb:i},function(t){t=a.parseJSON(t);var e=t.berat_badan;t=t.temp,t=JSON.stringify(t),customOption2a(t,e)})}),a("#btn_auto_off").click(function(a){optionSemua(getIdMerek())}),a("#inputSigna").keyup(function(t){var e=t.keyCode||t.which;13==e&&38==e&&40==e&&9==e||a.post(base+"/poli/ajax/selectsigna",{signa:a(this).val(),_token:a("#token").val()},function(t){t=JSON.parse(t);for(var e="",i=t.length-1;i>=0;i--)e+="<tr>",e+="<td>"+t[i].id+"</td>",e+="<td>"+t[i].signa+"</td>",e+='<td><button type="button" class="btn btn-success btn-xs" value="'+t[i].id+'" onclick="pilihSigna(this)">pilih</button></td>',e+="</tr>";0==t.length&&(e='<tr><td colspan="3" class="text-center">Data tidak ditemukan</td></tr>'),a("#tblSigna tbody").html(e)})}),a("#inputAturanMinum").keyup(function(t){var e=t.keyCode||t.which;13==e&&38==e&&40==e&&9==e||a.post(base+"/poli/ajax/selectatur",{aturan:a(this).val()},function(t){t=JSON.parse(t);for(var e="",i=t.length-1;i>=0;i--)e+="<tr>",e+="<td>"+t[i].id+"</td>",e+="<td>"+t[i].aturan_minum+"</td>",e+='<td><button type="button" class="btn btn-success  btn-xs" value="'+t[i].id+'" onclick="pilihAturanMinum(this)">pilih</button></td>',e+="</tr>";0==t.length&&(e='<tr><td colspan="3" class="text-center">Data tidak ditemukan</td></tr>'),a("#tblAturanMinum tbody").html(e)})}),a(".search").keyup(function(a){var t=a.keyCode||a.which;38!=t&&40!=t&&13!=t&&table_ICD()}),a(".search").on("keypress",function(t){var e=a("table#GridView4 tbody tr").filter(function(){var t="rgb(51, 122, 183)";return a(this).css("background-color")==t}).index(),i=t.keyCode||t.which;if(13==i&&e!=-1)confirmICD();else if(40==i&&e==-1)a("table#GridView4 tbody tr:first-child").toggleClass("rowHighlight");else if(40==i&&e!=-1&&9!=e){var e=a("table#GridView4 tbody tr").filter(function(){var t="rgb(51, 122, 183)";return a(this).css("background-color")==t}).index(),n=parseInt(e)+1,r=parseInt(e)+2;a("table#GridView4 tbody tr:nth-child("+n+")").toggleClass("rowHighlight"),a("table#GridView4 tbody tr:nth-child("+r+")").toggleClass("rowHighlight")}else if(38==i&&e!=-1&&0!=e){var e=a("table#GridView4 tbody tr").filter(function(){var t="rgb(51, 122, 183)";return a(this).css("background-color")==t}).index(),n=parseInt(e)+1,r=e;a("table#GridView4 tbody tr:nth-child("+n+")").toggleClass("rowHighlight"),a("table#GridView4 tbody tr:nth-child("+r+")").toggleClass("rowHighlight")}}),a("#tambahDiagnosa").on("keypress",function(t){var e=a("table#GridView2 tbody tr").filter(function(){var t="rgb(51, 122, 183)";return a(this).css("background-color")==t}).index(),i=a(this),n=parseInt(a("table#GridView2 tbody tr:last").index()),r=t.keyCode||t.which;if(13==r&&e==-1&&""!=i.val())insertDiagnosa();else{if(13==r&&e==-1&&""==i.val())return alert("Untuk masukkan diagnosa input harus diisi"),i.focus(),!1;if(13==r&&e!=-1)confirmDiagnosa();else if(40==r&&e==-1)a("table#GridView2 tbody tr:first-child").toggleClass("rowHighlight"),
a("#tambahDiagnosa").val("");else if(40==r&&e!=n){var d=parseInt(e)+1,l=parseInt(e)+2;a("table#GridView2 tbody tr:nth-child("+d+")").toggleClass("rowHighlight"),a("table#GridView2 tbody tr:nth-child("+l+")").toggleClass("rowHighlight"),a("#tambahDiagnosa").val("")}else{if(40==r&&e==n)return!1;if(38==r&&e!=-1&&0!=e){var e=a("table#GridView2 tbody tr").filter(function(){var t="rgb(51, 122, 183)";return a(this).css("background-color")==t}).index(),d=parseInt(e)+1,l=e;a("table#GridView2 tbody tr:nth-child("+d+")").toggleClass("rowHighlight"),a("table#GridView2 tbody tr:nth-child("+l+")").toggleClass("rowHighlight"),a("#tambahDiagnosa").val("")}else{if(38==r&&0==e)return!1;var e=a("table#GridView2 tbody tr").filter(function(){var t="rgb(51, 122, 183)";return a(this).css("background-color")==t}).index(),s=parseInt(e)+1;a("table#GridView2 tbody tr:nth-child("+s+")").toggleClass("rowHighlight")}}}}),a("#exampleModal").on("hidden.bs.modal",function(){a("#byICD").val(""),a("#byDiagnosa").val("").focus(),table_ICD()}),a(document).on("click","table#GridView4 tbody tr",function(t){a(".rowHighlight").toggleClass("rowHighlight"),a(this).toggleClass("rowHighlight"),a("#byDiagnosa").focus()}),a(document).on("click","table#GridView2 tbody tr",function(t){a(".rowHighlight").toggleClass("rowHighlight"),a(this).toggleClass("rowHighlight"),a("#tambahDiagnosa").focus()}),a(document).on("click","#confirmICD",function(t){var e=a("table#GridView4 tbody tr").filter(function(){var t="rgb(51, 122, 183)";return a(this).css("background-color")==t}).index();e!=-1?confirmICD():alert("pilih dulu ICD nya")}),a("#exampleModal1").on("show.bs.modal",function(){a("input#tambahDiagnosa").val("").keyup().focus()}),a("#inputTindakanSubmit").keypress(function(t){var e=t.keyCode||t.which;if(9==e)return a("#inputTindakanSubmit").click(),!1}),a("#modalTindakan").on("hidden.bs.modal",function(){bahanHabisPakai()}),a("#modalSigna").on("hidden.bs.modal",function(t){a("#ddlsigna").closest("div").find(".btn-white").focus()}),a("#modalAturanMinum").on("hidden.bs.modal",function(t){a("#ddlAturanMinum").closest("div").find(".btn-white").focus()}),a("#inputResep").keypress(function(t){var e=a(this),i=t.keyCode||t.which;return 9!=i&&13!=i||e.click(),!1}),a("#tipeResep").change(function(){var t=a(this).val(),e=getIdMerek();"1"==t?hideTipeResepPuyer(e):"2"==t?hideTipeResepSirup(e):"0"==t&&(a("#ddlsigna").val("").selectpicker("refresh").closest(".input-group").fadeIn(500),a("#ddlAturanMinum").val("").selectpicker("refresh").closest(".input-group").fadeIn(500),a("#txtjumlah").val("").selectpicker("refresh").fadeIn(500),optionSemua(e))}),a("#ddlNamaObat").change(function(){if(""!=a(this).val);else;var t=JSON.parse(a(this).val()),e=t.merek_id,i=getSediaan(),n=getMerek(),r=getIdFormula(),d=getTidakDipuyer(),l=a("#tipeResep").val();if("syrup"==i&&2==l)return alert("obat "+n+", tidak boleh dicampur dengan obat lain karena bukan dry syrup seperti \nAmoxilin Syr \nThiamphenicol syr \n Cefadroksil syr \n atau cefixim syr \nYang bisa dicampur dengan obat lain"),a("#ddlNamaObat").val("").selectpicker("refresh"),namaObatFocus(),!1;if("1"==d&&(1==l||2==l))return alert("obat "+n+", tidak boleh dipuyer ataupun dicampur ke dalam sirup"),a("#ddlNamaObat").val("").selectpicker("refresh"),namaObatFocus(),!1;"1"!=a("#tipeResep").val()||"-1"!=e&&"-3"!=e?"2"==a("#tipeResep").val()&&"-2"==e&&(a("#txtjumlah").val("1").selectpicker("refresh").closest(".input-group").fadeOut(500),a("#ddlsigna").val("").selectpicker("refresh").closest(".input-group").fadeIn(500),a("#ddlAturanMinum").val("1").selectpicker("refresh").closest(".input-group").fadeIn(500),a("#tipeResep").val("0").selectpicker("refresh"),optionSemua(e),a("#selesaikanAdd").html()&&selesaiAdd(a("#selesaikanAdd"))):(a("#ddlsigna").val("").selectpicker("refresh").closest(".input-group").fadeIn(500),a("#ddlAturanMinum").val("1").selectpicker("refresh").closest(".input-group").fadeIn(500),a("#tipeResep").val("0").selectpicker("refresh"),optionSemua(e),a("#selesaikanPuyer").html()&&selesaiPuyer(a("#selesaikanPuyer")));var s=getAturanMinumId();if(a("#ddlAturanMinum").val(s).selectpicker("refresh"),""!=a("#bb_aktif").val()&&""!=a("#ddlNamaObat").val()){var o=a("#ddlNamaObat option:selected").attr("data-dose");o=a.parseJSON(o);var u=o.signa_id,p=o.jumlah;a("#txtjumlah").val(p),a("#ddlsigna").val(u).selectpicker("refresh")}if(""!=a(this).val()){var m=a("#ddlNamaObat option:selected").attr("data-peringatan"),c="";if("null"!=m){c=m;var n=a("#ddlNamaObat option:selected").text(),g='<div class="panel panel-danger" id="isi_pesan"><div class="panel-heading"><h1 class="panel-title">'+n+'</h1></div><div class="panel-body">'+c+"</div></div>";a("#peringatan").html(g),a("#isi_pesan").hide().slideDown(500)}else a("#isi_pesan").slideUp(500,function(){a(this).remove()})}if("32"==a("#asuransi_id").val()&&""!=a(this).val()){var h=getIdRak(),b=a("#tipeResep").val(),n=a("#ddlNamaObat option:selected").text(),f=a("#ddlNamaObat option:selected").attr("data-fornas");if("D7"==h&&"1"==b);else if("0"==f){a("#isi_pesan_fornas").remove();var k='<div class="alert alert-danger" id="isi_pesan_fornas">'+n+" <strong>tidak ditanggung BPJS</strong></div>";a("#peringatan").prepend(k),a("#isi_pesan_fornas").hide().fadeIn(500)}else a("#isi_pesan_fornas").fadeOut(500,function(){a(this).remove()})}a.post(base+"/poli/ajax/ibusafe",{merek_id:a(this).val(),umur:a("#umur").html(),_token:a("#token").val()},function(t){t=a.trim(t),"1"==t&&(alert("Ibuprofen syrup / tablet tidak boleh digunakan untuk anak dibawah umur 1 tahun, gunakan ibuprofen suppositoria dalam kondisi darurat!! Optimalkan pemberian paracetamol 15 mg/kgbb tiap 4 jam, disertai dengan ibuprofen supp bila kepepet !!"),a("#ddlNamaObat").val("").selectpicker("refresh"))}),"1"==a("#hamil").val()?a.post(base+"/poli/ajax/pregsafe",{merek_id:a(this).val()},function(t){if(t=a.trim(t),""!=t){t=a.parseJSON(t);var e='<h4 class="text-center">Peringatan keamanan</h4>';e+='<h4 class="text-center">dalam kehamilan</h4>',e+='<table class="table table-condensed table-bordered font-kecil">',e+='<thead><tr><th class="bg-red">Generik</th><th class="bg-red">Safety Index</th></tr></thead>',e+="<tbody>";for(var i=0;i<t.length;i++)e+="<tr>",e+="<td>"+t[i].generik+" "+t[i].bobot+"</td>",e+="<td>"+t[i].pregnancy_safety_index+"</td>",e+="</tr>";e+="</tbody></table>",a("#legendpop").attr({title:a("#ddlNamaObat option:selected").text(),"data-original-title":a("#ddlNamaObat option:selected").text(),"data-content":e}),a("#legendpop").popover("show")}else a("#legendpop").popover("hide")}):"150805003"==a(this).val()?(a("#legendpop").attr({title:"Decafil tabet 150 mg","data-original-title":"Decafil tabet 150 mg","data-content":"Jika pasien sudah biasa/sering sesak nafas, decafil diberikan 20 tablet agar pasien tidak perlu bolak-balik ke klinik, termasuk dan terutama pasien BPJS"}),a("#legendpop").popover("show")):"150802046"==r&&"32"==a("#asuransi_id").val()?(a("#legendpop").attr({title:"Levofloxacine tabet 500 mg","data-original-title":"Levofloxacine tabet 500 mg","data-content":"Pada pasien BPJS dengan Typhoid fever, obat ini diberikan selama 6 hari, obat simtomatik lain diberikan selama 3 hari, diharapkan pasien tidak kontrol kalau keadaan membaik dan tinggal habiskan antibiotiknya saja"}),a("#legendpop").popover("show")):a("#legendpop").popover("hide")}),a('[data-toggle="popover"]').popover(),sesuaikanResep(),a("#pemeriksaan_penunjang").keypress(function(t){var e=t.keyCode||t.which;if(9!=e)return a("#modalTindakan").modal("show"),a(this).blur(),!1}),setTimeout(function(){a("#anamnesa").focus()},500),a(".afi_count").keyup(function(a){afiCount()})}),$("#inputAturanMinum").focus();var ID_SIGNA_BARU="",ID_ATURAN_MINUM_BARU="";$(".hide-panel").closest(".panel").find(".panel-heading").css("border","3px border red"),$(".hide-panel").closest(".panel").find(".panel-heading").css("cursor","pointer"),$(".hide-panel").closest(".panel").find(".panel-heading").click(function(a){""==$("#resepluar").val()&&($(this).closest(".panel").find(".hide-panel").slideToggle(function(){$(this).closest(".panel").find(".resepluar").focus()}),$('.unhide-panel:not([src="'+base+'/notfound.jpg"])').toggle())});var riwayat=[];$("#input_riwayat").keydown(function(a){var t=a.keyCode||a.which;if(9==t)return $("#input_riwayat").click(),!1});